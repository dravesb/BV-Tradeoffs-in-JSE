Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
scale_size_continuous(limits = c(0, 0.25)) +
scale_alpha_continuous(limits = c(0, 0.25)) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
scale_size_continuous(limits = c(0, 1)) +
scale_alpha_continuous(limits = c(0, 0.25)) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
scale_size_continuous(limits = c(0, 5)) +
scale_alpha_continuous(limits = c(0, 0.25)) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
scale_size_continuous(limits = c(0, 10)) +
scale_alpha_continuous(limits = c(0, 0.25)) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
scale_size_continuous(limits = c(5, 10)) +
scale_alpha_continuous(limits = c(0, 0.25)) +
theme_bw()
1/5
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
#scale_size_continuous(limits = c(5, 10)) +
#scale_alpha_continuous(limits = c(0, 0.25)) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
scale_size_continuous(limits = c(0, 1)) +
#scale_alpha_continuous(limits = c(0, 0.25)) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
scale_size_continuous(range = c(0, .5)) +
#scale_alpha_continuous(limits = c(0, 0.25)) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
scale_size_continuous(range = c(0.1, .5)) +
scale_alpha_continuous(range = c(0, 0.25)) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(size = 1/m, alpha = 1/m)) +
facet_grid(Method~m) +
scale_size_continuous(range = c(0.1, .5)) +
scale_alpha_continuous(range = c(.5, 1)) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(size = .5, alpha = 0.8) +
facet_grid(Method~m) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(size = .5, alpha = 0.8) +
facet_grid(Method~m) +
state_ellipse() +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(size = .5, alpha = 0.8) +
facet_grid(Method~m) +
stat_ellipse() +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(size = .5, alpha = 0.8) +
facet_grid(Method~m) +
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(size = .5, alpha = 0.8, col = 'blue') +
facet_grid(Method~m) +
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(size = .25, alpha = 0.8, col = 'blue') +
facet_grid(Method~m) +
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(size = .25, alpha = 0.8, col = 'red') +
facet_grid(Method~m) +
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method), size = .25, alpha = 0.8) +
facet_grid(Method~m) +
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = 1/m), size = .25) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.25, .5))
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = 1/m), size = .25) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.25, .5))+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = 1/m), size = 1) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.25, .5))+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = 1/m), size = .75) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.25, .5), )+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = 1/m), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.25, .5), )+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = 1/m), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75), )+
stat_ellipse(linetype = 2) +
theme_bw()
#set model parameters
set.seed(1985)
n <- 100
m_vec <- c(5, 25, 50)
X <- diag(runif(n)) %*% rdirichlet(n, c(1, 1))
d <- 2
df_list <- list()
# start simulation
for(i in 1:length(m_vec)){
# sample A matrices
A_list <- lapply(1:m_vec[i], function(i) sampP(tcrossprod(X)))
# Embedd
X_aase <- ase(Reduce('+', A_list)/m_vec[i], d)
X_omni <- omni(A_list, d)
X_obar <- Reduce('+', X_omni)/m_vec[i]
# rotate to X
X_aase <- procrustes(X_aase, X)$X.new
X_omni <- procrustes(X_omni[[1]], X)$X.new
X_obar <- procrustes(X_obar, X)$X.new
# store
df_list[[i]] <- rbind(X_aase - X, X_omni - X, X_obar - X) %>%
as.data.frame() %>%
mutate(Method = rep(c('AASE', 'OMNI', 'OBAR'), each = n),
m = m_vec[i])
}
# plot
Reduce('rbind', df_list) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = 1/m), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75), )+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(m = paste('m = ', m)) %>%
ungroup() %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = 1/m), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75), )+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m = ', m)) %>%
ungroup() %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75), )+
stat_ellipse(linetype = 2) +
theme_bw()
paste('m =', m_vec)
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m = ', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75), )+
stat_ellipse(linetype = 2) +
theme_bw()
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m = ', m)) %>%
ungroup()
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75), )+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75), guide = 'none')+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75), guide = 'none')+
scale_color_manual(guide = 'none')+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5, guide = 'none') +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75), guide = 'none')+
#scale_color_manual(guide = 'none')+
stat_ellipse(linetype = 2) +
theme_bw()
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75))+
#scale_color_manual(guide = 'none')+
stat_ellipse(linetype = 2) +
theme_bw() +
guides(col = 'none', alpha = 'non')
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75))+
#scale_color_manual(guide = 'none')+
stat_ellipse(linetype = 2) +
theme_bw() +
guides(color = 'none', alpha = 'non')
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75))+
#scale_color_manual(guide = 'none')+
stat_ellipse(linetype = 2) +
theme_bw() +
guides(color = 'none', alpha = 'none')
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75))+
stat_ellipse(linetype = 2) +
theme_bw() +
guides(color = 'none', alpha = 'none') +
labs(x = '', y = '')
ggsave('~/Documents/Work/github/Thesis/Simulations/Chapter_4/Large_m/figures/m_concentration.pdf',
device = "pdf",width = 6, height = 5, unts = "in")
ggsave('~/Documents/Work/github/Thesis/Simulations/Chapter_4/Large_m/figures/m_concentration.pdf',
device = "pdf",width = 6, height = 5, unts = "inches")
ggsave('~/Documents/Work/github/Thesis/Simulations/Chapter_4/Large_m/figures/m_concentration.pdf',
device = "pdf",width = 6, height = 5, units = "in")
ggsave('~/Documents/Work/github/Thesis/Simulations/Chapter_4/Large_m/figures/m_concentration.pdf',
device = "pdf",width = 7, height = 5, units = "in")
#set model parameters
set.seed(1985)
n <- 100
m_vec <- c(5, 25, 50)
X <- diag(runif(n)) %*% rdirichlet(n, c(1, 1))
d <- 2
df_list <- list()
i <- 1
# Embedd
X_aase <- ase(Reduce('+', A_list)/m_vec[i], d)
X_omni <- omni(A_list, d)
X_obar <- Reduce('+', X_omni)/m_vec[i]
X_mase <- mase(A_list, d_list = rep(d, m_vec[i]), d)
warnings()
mase
i
mase
mase(A_list, d_list = rep(d, m_vec[i]), d)
X_mase <- mase(A_list, d_list = rep(d, m_vec[i]), d)
X_mase[[1]]
plot(X_mase[[1]])
plot(X_mase)
plot(X)
mase
d_list <- rep(d, m_vec[i])
d_list
X_ase <- lapply(1:length(A_list), function(g) ase(A_list[[g]], d_list[g]))
ase
eigen(A_list[[1]])
plot(eigen(A_list[[1]])$values)
plot(eigen(A_list[[1]])$values, cex = .1)
length(A_list)
# sample A matrices
A_list <- lapply(1:m_vec[i], function(i) sampP(tcrossprod(X)))
# Embedd
X_aase <- ase(Reduce('+', A_list)/m_vec[i], d)
X_omni <- omni(A_list, d)
X_mase <- mase(A_list, d_list = rep(d, m_vec[i]), d)
X_obar <- Reduce('+', X_omni)/m_vec[i]
X_mase
X_mase <- procrustes(X_mase[[1]], X)$X.new
source('~/Desktop/OmniAnalysis/code_base/loadAll.R')
set.seed(1985)
n <- 100
m_vec <- c(5, 25, 50)
X <- diag(runif(n)) %*% rdirichlet(n, c(1, 1))
d <- 2
df_list <- list()
# start simulation
for(i in 1:length(m_vec)){
# sample A matrices
A_list <- lapply(1:m_vec[i], function(i) sampP(tcrossprod(X)))
# Embedd
X_aase <- ase(Reduce('+', A_list)/m_vec[i], d)
X_omni <- omni(A_list, d)
X_mase <- mase(A_list, d_list = rep(d, m_vec[i]), d)
X_obar <- Reduce('+', X_omni)/m_vec[i]
# rotate to X
X_aase <- procrustes(X_aase, X)$X.new
X_omni <- procrustes(X_omni[[1]], X)$X.new
X_mase <- procrustes(X_mase[[1]], X)$X.new
X_obar <- procrustes(X_obar, X)$X.new
# store
df_list[[i]] <- rbind(X_aase - X, X_omni - X, X_obar - X) %>%
as.data.frame() %>%
mutate(Method = rep(c('AASE', 'OMNI', 'OBAR'), each = n),
m = m_vec[i])
}
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75))+
stat_ellipse(linetype = 2) +
theme_bw() +
guides(color = 'none', alpha = 'none') +
labs(x = '', y = '')
#==============================================
#
#       Simulation to see concentration
#         rate of AASE and OMNI for large m
#
#==============================================
source('~/Desktop/OmniAnalysis/code_base/loadAll.R')
#set model parameters
set.seed(1985)
n <- 100
m_vec <- c(5, 25, 50)
X <- diag(runif(n)) %*% rdirichlet(n, c(1, 1))
d <- 2
df_list <- list()
# start simulation
for(i in 1:length(m_vec)){
# sample A matrices
A_list <- lapply(1:m_vec[i], function(i) sampP(tcrossprod(X)))
# Embedd
X_aase <- ase(Reduce('+', A_list)/m_vec[i], d)
X_omni <- omni(A_list, d)
X_mase <- mase(A_list, d_list = rep(d, m_vec[i]), d)
X_obar <- Reduce('+', X_omni)/m_vec[i]
# rotate to X
X_aase <- procrustes(X_aase, X)$X.new
X_omni <- procrustes(X_omni[[1]], X)$X.new
X_mase <- procrustes(X_mase[[1]], X)$X.new
X_obar <- procrustes(X_obar, X)$X.new
# store
df_list[[i]] <- rbind(X_aase - X, X_omni - X, X_obar - X, X_mase - X) %>%
as.data.frame() %>%
mutate(Method = rep(c('AASE', 'OMNI', 'OBAR', 'MASE'), each = n),
m = m_vec[i])
}
# plot
Reduce('rbind', df_list) %>%
rowwise() %>%
mutate(alpha = 1/m,
m = paste('m =', m)) %>%
ungroup() %>%
mutate(m = factor(m, levels = paste('m =', m_vec))) %>%
ggplot(aes(x = V1, y = V2)) +
geom_point(aes(col = Method, alpha = alpha), size = .5) +
facet_grid(Method~m) +
scale_alpha_continuous(range = c(.5, .75))+
stat_ellipse(linetype = 2) +
theme_bw() +
guides(color = 'none', alpha = 'none') +
labs(x = '', y = '')
ggsave('~/Documents/Work/github/Thesis/Simulations/Chapter_4/Large_m/figures/m_concentration.pdf',
device = "pdf",width = 7, height = 5, units = "in")
